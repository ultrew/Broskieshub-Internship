# Internship Report — Task1 [Web Application Vulnerability Testing]

**Intern:** [Tanishq Nama]

**Internship:** [Broskieshub]

**Environment:** Kali Linux (host), DVWA v1.10, Burp Suite, Browser: Brave.

---

## 1. Executive Summary

I conducted a focused set of web application security tests against a controlled target (DVWA). My objective was to identify, exploit (in a lab environment), and document the following common vulnerabilities: **Command Injection**, **File Inclusion (LFI/RFI)**, **SQL Injection**, and **Authentication Brute-Force**. For each vulnerability I describe my approach, proof-of-concept (PoC) evidence (screenshots saved in `Screenshots/`), risk assessment, and recommended fixes. Testing was performed on authorized systems and in a lab environment.

---

## 2. Objectives

1. Learn and demonstrate practical exploitation techniques for common web vulnerabilities.
2. Produce clear, reproducible documentation for each finding suitable for a GitHub repository.
3. Recommend concrete mitigations and verify fixes where possible.

---

## 3. Scope & Rules of Engagement

- **Scope:** Target:  (DVWA). Only the listed endpoints and services were tested.
- **Authorization:** I have explicit permission to test the target in the lab environment.
- **Tools used:** Kali Linux, Burp Suite, other CLI utilities.
- **Data handling:** Screenshots saved to the `Screenshots/` and files used in `Files/` directories.

---

## 4. Methodology

I followed a simple repeatable process for each vulnerability:

1. Reconnaissance — Identify entry points and inputs (forms, parameters etc).
2. Confirmatory Testing — Use safe tests to confirm the presence of a vulnerability.
3. Exploitation (PoC) — Generate a reproducible PoC that demonstrates impact. Capture screenshots.
4. Risk Assessment — Rate the severity and explain impact.
5. Remediation — Provide fixes, code examples.

---

## 5. Findings (Per-Vulnerability Sections)

> **Note:** Each vulnerability below follows the same sub-section pattern: *Overview*, *Target & Entry Point*, *Reproduction Steps (PoC)*, *Evidence (screenshots)*, *Impact / Risk*, *Root Cause*, *Fix / Mitigation*.

### 5.1 Command Injection

**Overview —** I tested the Command Injection tab of DVWA.

**Target & Entry Point —** `http://172.17.0.1:8080/vulnerabilities/exec/`

**Reproduction Steps (PoC) —**
1. I opened the `Command Injection` tab of DVWA and used the ping field.
2. Entered `127.0.0.1` to confirm normal behavior.
3. Then used the payload:

```sh
127.0.0.1 && cat ../../../../../etc/passwd
```

4. The response displayed `/etc/passwd` contents. Screenshot saved as `Screenshots/Command_Injection.png`.

**Evidence (screenshots/logs)**
- `Screenshots/Command_Injection.png` — Response showing passwd data.

**Impact / Risk —** Remote command execution can lead to full system compromise, data exposure, or lateral movement. Severity: **High**.

**Root Cause —** Unsafe concatenation of user input into OS command execution functions without validation or escaping.

**Fix / Mitigation —** recommended fix:

- Avoid invoking shell commands with unsanitized user input. Use native libraries/APIs.
- If shell execution is unavoidable, strictly validate input against an allowlist and use functions that bypass the shell (e.g., `execv` family) with parameter arrays.
- Example (PHP) — *unsafe* vs *safer* patterns:

```php
// Unsafe
$host = $_GET['host'];
$cmd = "ping -c 4 " . $host;
$output = shell_exec($cmd);

// Safer (validate and escape)
$host = $_GET['host'];
if (!preg_match('/^[0-9a-zA-Z\.\-]+$/', $host)) {
    die('invalid host');
}
$escaped = escapeshellarg($host);
$output = shell_exec("ping -c 4 $escaped");
```

- Prefer native libraries for the required action (e.g., use `socket` or DNS libraries rather than running `ping`).

---

### 5.2 File Inclusion

**Overview —** I tested the File Inclusion (LFI) functionality in DVWA and verified local file reading.

**Target & Entry Point —** `http://172.17.0.1:8080/vulnerabilities/fi/?page=../../../../../../etc/passwd` — parameter: `page=`

**Reproduction Steps (PoC)**
1. Supplied payloads like `?page=../../../../../../etc/passwd` to check local file access.

**Evidence (screenshots/logs)**
- `Screenshots/File_Inclusion_LFI.png` — Partial `/etc/passwd` content displayed.

**Impact / Risk —** LFI can leak sensitive files; combined with upload or log poisoning, it may lead to remote code execution. Severity: **High**.

**Root Cause —** Unsanitized file path handling and direct inclusion of user-supplied path segments.

**Fix / Mitigation —**
- Normalize and canonicalize file paths and restrict access to a safe directory (use chroot or a configured template directory).
- Block `..` sequences and disallow URL wrappers if not required.
- Example (PHP) — allowlist approach:

```php
$allowed_pages = ['home', 'about', 'contact'];
$page = $_GET['page'] ?? 'home';
if (!in_array($page, $allowed_pages)) {
    $page = '404';
}
include __DIR__ . '/pages/' . $page . '.php';
```

---

### 5.3 SQL Injection

**Overview —** In the SQL Injection tab I found input fields that allowed data retrieval.

**Target & Entry Point —** search field (`user id`).

**Reproduction Steps (PoC)**
1. Tested with payloads such as `\' OR \'1\'=\'1` and observed that the application returned broad user data.

**Evidence (screenshots/logs)**
- `Screenshots/SQL_Injection.png` — User data retrieved via injection.

**Impact / Risk —** Data leakage, authentication bypass, or in some cases remote code execution. Severity: **High/Medium** depending on exposure.

**Root Cause —** Direct concatenation of inputs into SQL queries without parameterized queries.

**Fix / Mitigation —**
- Use parameterized prepared statements or ORM query builders; never concatenate raw user input into SQL.
- Example (PHP PDO):

```php
$stmt = $pdo->prepare('SELECT id FROM users WHERE username = :u AND password = :p');
$stmt->execute([':u' => $username, ':p' => $password]);
```

---

### 5.4 Authentication Brute-Force

**Overview —** I tested the login endpoint for weak rate limiting and credential stuffing using Burp Suite to perform a password-guessing attack and verified the working credential in Repeater.

**Target & Entry Point —** Login form: `http://172.17.0.1:8080/vulnerabilities/brute/` with `username` and `password` fields.

**Reproduction Steps (PoC)**
- Captured a login request in Burp Suite Proxy during a legitimate login flow.
- Sent the captured request to **Intruder** in Burp Suite.
- Configured Intruder using the **Sniper** attack type, marked the `password` parameter as the payload position, and loaded a focused `Files/Resources/pass.txt` wordlist as the payload.
- Launched the Sniper attack and monitored responses for anomalies (response length, status, or distinctive body differences) that indicate a successful attempt.
- Identified a candidate password from Intruder that produced a noticeably different/successful response.
- Replayed the successful payload in **Repeater** to confirm — the Repeater response returned the authenticated page (dashboard/home content), demonstrating a successful login with the discovered password.

**Evidence (screenshots/logs)**
- `Screenshots/Brute_force1.png` — Intruder with login request captured.
- `Screenshots/Brute_force2.png` — Burp showing brute force attack progress/results.
- `Screenshots/Brute_force3.png` — Burp Repeater showing successful login confirmation.

**Impact / Risk —** Account takeover, especially for accounts with weak passwords or reused credentials. Severity: **Medium/High**.

**Root Cause —** No account lockout, lack of rate limiting, and no detection for repeated failed attempts.

**Fix / Mitigation —**
- Implement progressive delays or temporary account lockouts on failed attempts.
- Use multi-factor authentication (MFA) for privileged accounts.
- Add IP-based rate limiting and detection/alerting on suspicious activity.

---

## 8. Conclusion & Learnings

During this internship I deepened my practical knowledge of web vulnerabilities and secure coding practices. I practiced responsible disclosure, produced reproducible PoCs, and learned about recommended mitigations.

---

**References:**
- OWASP Top 10
- DVWA documentation
- Burp Suite docs

---

**End of report**.

